normal = [
    {'S': 0,  'A': 1, 'Z': 1, 'M': 938.272, 'Name': 'p'},
    {'S': 0,  'A': 2, 'Z': 1, 'M': 1875.613, 'Name': 'd'},
    {'S': 0,  'A': 3, 'Z': 1, 'M': 2808.921, 'Name': 't'},
    {'S': 0,  'A': 3, 'Z': 2, 'M': 2808.391, 'Name': 'He3'},
    {'S': 0,  'A': 4, 'Z': 1, 'M': 3750.086, 'Name': 'H4', 'VeryShortLife': True},
    {'S': 0,  'A': 4, 'Z': 2, 'M': 3727.379, 'Name': 'He4'},
    {'S': 0,  'A': 5, 'Z': 2, 'M': 4667.680, 'Name': 'He5', 'VeryShortLife': True},
    {'S': 0,  'A': 5, 'Z': 3, 'M': 4667.616, 'Name': 'Li5', 'VeryShortLife': True},
    {'S': 0,  'A': 6, 'Z': 2, 'M': 5605.534, 'Name': 'He6'},
    {'S': 0,  'A': 6, 'Z': 3, 'M': 5601.518, 'Name': 'Li6'},
    {'S': 0,  'A': 6, 'Z': 4, 'M': 5605.296, 'Name': 'Be6', 'VeryShortLife': True},
    {'S': 0,  'A': 7, 'Z': 2, 'M': 6545.510, 'Name': 'He7', 'VeryShortLife': True},
    {'S': 0,  'A': 7, 'Z': 3, 'M': 6533.833, 'Name': 'Li7'},
    {'S': 0,  'A': 7, 'Z': 4, 'M': 6534.184, 'Name': 'Be7'},
    {'S': 0,  'A': 8, 'Z': 2, 'M': 7482.540, 'Name': 'He8'},
    {'S': 0,  'A': 8, 'Z': 3, 'M': 7471.365, 'Name': 'Li8'},
    {'S': 0,  'A': 8, 'Z': 4, 'M': 7454.851, 'Name': 'Be8', 'VeryShortLife': True},
    {'S': 0,  'A': 8, 'Z': 5, 'M': 7472.320, 'Name': 'B8'},
    {'S': 0,  'A': 9, 'Z': 2, 'M': 8423.360, 'Name': 'He9', 'VeryShortLife': True},
    {'S': 0,  'A': 9, 'Z': 3, 'M': 8406.868, 'Name': 'Li9'},
    {'S': 0,  'A': 9, 'Z': 4, 'M': 8392.751, 'Name': 'Be9'},
    {'S': 0,  'A': 9, 'Z': 5, 'M': 8393.309, 'Name': 'B9'},
    {'S': 0,  'A': 9, 'Z': 6, 'M': 8409.293, 'Name': 'C9'},
    {'S': 0,  'A': 10, 'Z': 3, 'M': 9346.460, 'Name': 'Li10', 'VeryShortLife': True},
    {'S': 0,  'A': 10, 'Z': 4, 'M': 9325.504, 'Name': 'Be10'},
    {'S': 0,  'A': 10, 'Z': 5, 'M': 9324.437, 'Name': 'B10'},
    {'S': 0,  'A': 10, 'Z': 6, 'M': 9327.574, 'Name': 'C10'},
    {'S': 0,  'A': 11, 'Z': 3, 'M': 10285.630, 'Name': 'Li11'},
    {'S': 0,  'A': 11, 'Z': 4, 'M': 10264.568, 'Name': 'Be11'},
    {'S': 0,  'A': 11, 'Z': 5, 'M': 10252.548, 'Name': 'B11'},
    {'S': 0,  'A': 11, 'Z': 6, 'M': 10254.019, 'Name': 'C11'},
    {'S': 0,  'A': 12, 'Z': 4, 'M': 11200.963, 'Name': 'Be12'},
    {'S': 0,  'A': 12, 'Z': 5, 'M': 11188.744, 'Name': 'B12'},
    {'S': 0,  'A': 12, 'Z': 6, 'M': 11174.864, 'Name': 'C12'},
    {'S': 0,  'A': 12, 'Z': 7, 'M': 11191.691, 'Name': 'N12'},
    {'S': 0,  'A': 13, 'Z': 4, 'M': 12141.038, 'Name': 'Be13'},
    {'S': 0,  'A': 13, 'Z': 5, 'M': 12123.430, 'Name': 'B13'},
    {'S': 0,  'A': 13, 'Z': 6, 'M': 12109.483, 'Name': 'C13'},
    {'S': 0,  'A': 13, 'Z': 7, 'M': 12111.193, 'Name': 'N13'},
    {'S': 0,  'A': 13, 'Z': 8, 'M': 12128.452, 'Name': 'O13'},
    {'S': 0,  'A': 14, 'Z': 4, 'M': 13078.827, 'Name': 'Be14'},
    {'S': 0,  'A': 14, 'Z': 5, 'M': 13062.026, 'Name': 'B14'},
    {'S': 0,  'A': 14, 'Z': 6, 'M': 13040.872, 'Name': 'C14'},
    {'S': 0,  'A': 14, 'Z': 7, 'M': 13040.204, 'Name': 'N14'},
    {'S': 0,  'A': 14, 'Z': 8, 'M': 13044.839, 'Name': 'O14'},
    {'S': 0,  'A': 15, 'Z': 5, 'M': 13998.815, 'Name': 'B15'},
    {'S': 0,  'A': 15, 'Z': 6, 'M': 13979.219, 'Name': 'C15'},
    {'S': 0,  'A': 15, 'Z': 7, 'M': 13968.936, 'Name': 'N15'},
    {'S': 0,  'A': 15, 'Z': 8, 'M': 13971.181, 'Name': 'O15'},
    {'S': 0,  'A': 16, 'Z': 5, 'M': 14938.463, 'Name': 'B16'},
    {'S': 0,  'A': 16, 'Z': 6, 'M': 14914.534, 'Name': 'C16'},
    {'S': 0,  'A': 16, 'Z': 7, 'M': 14906.013, 'Name': 'N16'},
    {'S': 0,  'A': 16, 'Z': 8, 'M': 14895.082, 'Name': 'O16'},
    {'S': 0,  'A': 17, 'Z': 5, 'M': 15876.561, 'Name': 'B17'},
    {'S': 0,  'A': 17, 'Z': 6, 'M': 15853.366, 'Name': 'C17'},
    {'S': 0,  'A': 17, 'Z': 7, 'M': 15839.694, 'Name': 'N17'},
    {'S': 0,  'A': 17, 'Z': 8, 'M': 15830.504, 'Name': 'O17'},

    {'S': 0,  'A': 18, 'Z': 5, 'M': 16816.132, 'Name': 'B18'},
    {'S': 0,  'A': 18, 'Z': 6, 'M': 16788.747, 'Name': 'C18'},
    {'S': 0,  'A': 18, 'Z': 7, 'M': 16776.431, 'Name': 'N18'},
    {'S': 0,  'A': 18, 'Z': 8, 'M': 16762.024, 'Name': 'O18'},
    {'S': 0,  'A': 19, 'Z': 5, 'M': 17755.603, 'Name': 'B19'},
    {'S': 0,  'A': 19, 'Z': 6, 'M': 17727.736, 'Name': 'C19'},
    {'S': 0,  'A': 19, 'Z': 7, 'M': 17710.667, 'Name': 'N19'},
    {'S': 0,  'A': 19, 'Z': 8, 'M': 17697.634, 'Name': 'O19'},

    {'S': 0,  'A': 0, 'Z': -1, 'M': 139.570, 'Name': 'pi-'},]
neutrals = [
    {'S': 0,  'A': 1, 'Z': 0, 'M': 939.565, 'Name': 'n', 'SingleParticle': True},
    {'S': 0,  'A': 2, 'Z': 0, 'M': 939.565 * 2, 'Name': '2n', 'SingleParticle': False},
    {'S': 0,  'A': 3, 'Z': 0, 'M': 939.565 * 3, 'Name': '3n', 'SingleParticle': False},
    {'S': 0,  'A': 0, 'Z': 0, 'M': 134.977, 'Name': 'pi0', 'SingleParticle': True},
    {'S': 0,  'A': 1, 'Z': 0, 'M': 134.977 + 939.565, 'Name': 'pi0 + n', 'SingleParticle': False},
    {'S': 0,  'A': 2, 'Z': 0, 'M': 134.977 + 939.565 * 2, 'Name': 'pi0 + 2n', 'SingleParticle': False},

    {'S': -1, 'A': 1, 'Z': 0, 'M': 1115.683, 'Name': 'L', 'SingleParticle': True},
    {'S': -1, 'A': 2, 'Z': 0, 'M': 1115.683 + 939.565,  'Name': 'L + n', 'SingleParticle': False},
    {'S': -1, 'A': 3, 'Z': 0, 'M': 1115.683 + 939.565 * 2, 'Name': 'L + 2n', 'SingleParticle': False},

    {'S': -2, 'A': 2, 'Z': 0, 'M': 1115.683 * 2, 'Name': '2L', 'SingleParticle': False},
    {'S': -2, 'A': 3, 'Z': 0, 'M': 1115.683 * 2 + 939.565,  'Name': '2L + n', 'SingleParticle': False},

    {'S': 0,  'A': 0, 'Z': 0, 'M': 0, 'Name': 'null', 'SingleParticle': True},]
single_hyper = [
    {'S': -1, 'A': 1, 'Z': 0, 'M': 1115.683, 'M_Error': 0.006, 'Name': 'L_sim', 'BL_Type': 'Published'},
    {'S': -1, 'A': 1, 'Z': 1, 'M': 1187.37, 'M_Error': 0.07, 'Name': 'Sigma+_sim', 'BL_Type': 'Published'},
    {'S': -1, 'A': 3, 'Z': 1, 'M': 1875.613 + 1115.683, 'M_Error': 0.05, 'Name': 'H3L', 'BL_Type': 'Published'},
    {'S': -1, 'A': 4, 'Z': 1, 'M': 2808.921 + 1115.683, 'M_Error': 0.04, 'Name': 'H4L', 'BL_Type': 'Published'},
    {'S': -1, 'A': 4, 'Z': 2, 'M': 2808.391 + 1115.683 - 2.39, 'M_Error': 0.03, 'Name': 'He4L', 'BL_Type': 'Published'},
    {'S': -1, 'A': 5, 'Z': 2, 'M': 3727.379 + 1115.683 - 3.12, 'M_Error': 0.02, 'Name': 'He5L', 'BL_Type': 'Published'},
    {'S': -1, 'A': 6, 'Z': 2, 'M': 4667.680 + 1115.683 - 4.18, 'M_Error': 0.10, 'Name': 'He6L', 'BL_Type': 'Published'},
    {'S': -1, 'A': 6, 'Z': 3, 'M': 4667.616 + 1115.683 - 4.50, 'M_Error': 0.50, 'Name': 'Li6L', 'BL_Type': 'Published'},
    {'S': -1, 'A': 7, 'Z': 2, 'M': 5605.534 + 1115.683 - 5.55, 'M_Error': 0.15, 'Name': 'He7L', 'BL_Type': 'Published'},
    {'S': -1, 'A': 7, 'Z': 3, 'M': 5601.518 + 1115.683 - 5.58, 'M_Error': 0.03, 'Name': 'Li7L', 'BL_Type': 'Published'},
    {'S': -1, 'A': 7, 'Z': 4, 'M': 5605.296 + 1115.683 - 5.16, 'M_Error': 0.08, 'Name': 'Be7L', 'BL_Type': 'Published'},
    {'S': -1, 'A': 8, 'Z': 2, 'M': 6545.510 + 1115.683 - 7.16, 'M_Error': 0.70, 'Name': 'He8L', 'BL_Type': 'Published'},
    {'S': -1, 'A': 8, 'Z': 3, 'M': 6533.833 + 1115.683 - 6.80, 'M_Error': 0.03, 'Name': 'Li8L', 'BL_Type': 'Published'},
    {'S': -1, 'A': 8, 'Z': 4, 'M': 6534.184 + 1115.683 - 6.84, 'M_Error': 0.05, 'Name': 'Be8L', 'BL_Type': 'Published'},
    {'S': -1, 'A': 9, 'Z': 3, 'M': 7471.365 + 1115.683 - 8.50, 'M_Error': 0.12, 'Name': 'Li9L', 'BL_Type': 'Published'},
    {'S': -1, 'A': 9, 'Z': 4, 'M': 7454.851 + 1115.683 - 6.71, 'M_Error': 0.04, 'Name': 'Be9L', 'BL_Type': 'Published'},
    {'S': -1, 'A': 9, 'Z': 5, 'M': 7472.320 + 1115.683 - 8.29, 'M_Error': 0.18, 'Name': 'B9L', 'BL_Type': 'Published'},
    {'S': -1, 'A': 10, 'Z': 4, 'M': 8392.751 + 1115.683 - 8.60, 'M_Error': 0.17, 'Name': 'Be10L', 'BL_Type': 'Published_i'},
    {'S': -1, 'A': 10, 'Z': 5, 'M': 8393.309 + 1115.683 - 8.89, 'M_Error': 0.12, 'Name': 'B10L', 'BL_Type': 'Published'},
    {'S': -1, 'A': 11, 'Z': 5, 'M': 9324.437 + 1115.683 - 10.24, 'M_Error': 0.05, 'Name': 'B11L', 'BL_Type': 'Published'},
    {'S': -1, 'A': 12, 'Z': 5, 'M': 10252.548 + 1115.683 - 11.37, 'M_Error': 0.06, 'Name': 'B12L', 'BL_Type': 'Published'},
    {'S': -1, 'A': 12, 'Z': 6, 'M': 10254.019 + 1115.683 - 10.80, 'M_Error': 0.18, 'Name': 'C12L', 'BL_Type': 'Published'},
    {'S': -1, 'A': 13, 'Z': 6, 'M': 11174.864 + 1115.683 - 11.69, 'M_Error': 0.12, 'Name': 'C13L', 'BL_Type': 'Published'},
    {'S': -1, 'A': 13, 'Z': 6, 'M': 11174.864 + 1115.683 - 11.69 + 4.88, 'M_Error': 0.12, 'Name': 'C13Le', 'BL_Type': 'Published'},
    {'S': -1, 'A': 14, 'Z': 6, 'M': 12109.483 + 1115.683 - 12.17, 'M_Error': 0.33, 'Name': 'C14L', 'BL_Type': 'Published'},
    {'S': -1, 'A': 14, 'Z': 7, 'M': 12111.193 + 1115.683 - 12.17, 'M_Error': 0.33, 'Name': 'N14L', 'BL_Type': 'Published'},
    {'S': -1, 'A': 15, 'Z': 7, 'M': 13040.204 + 1115.683 - 13.59, 'M_Error': 0.15, 'Name': 'N15L', 'BL_Type': 'Published'},
    {'S': -1, 'A': 16, 'Z': 7, 'M': 13968.936 + 1115.683 - 13.76, 'M_Error': 0.16, 'Name': 'N16L', 'BL_Type': 'Published'},
    {'S': -1, 'A': 16, 'Z': 8, 'M': 13971.181 + 1115.683 - 12.42, 'M_Error': 0.05, 'Name': 'O16L', 'BL_Type': 'Published'},

    {'S': -1, 'A': 5, 'Z': 1, 'M': 3750.086 + 1115.683 - 3.950, 'M_Error': 1.0, 'Name': 'H5L', 'BL_Type': 'Estimated'},
    {'S': -1, 'A': 9, 'Z': 2, 'M':  7482.540 + 1115.683 - 6.599, 'M_Error': 1.0, 'Name': 'He9L', 'BL_Type': 'Estimated'},
    {'S': -1, 'A': 10, 'Z': 2, 'M': 8423.360 + 1115.683 - 7.456, 'M_Error': 1.0, 'Name': 'He10L', 'BL_Type': 'Estimated'},
    {'S': -1, 'A': 10, 'Z': 3, 'M': 8406.868 + 1115.683 - 9.418, 'M_Error': 1.0, 'Name': 'Li10L', 'BL_Type': 'Estimated'},
    {'S': -1, 'A': 11, 'Z': 3, 'M': 9346.460 + 1115.683 - 10.705, 'M_Error': 1.0, 'Name': 'Li11L', 'BL_Type': 'Estimated'},
    {'S': -1, 'A': 11, 'Z': 4, 'M': 9325.504 + 1115.683 - 8.21, 'M_Error': 1.0, 'Name': 'Be11L', 'BL_Type': 'Estimated'},
    {'S': -1, 'A': 12, 'Z': 4, 'M': 10264.568 + 1115.683 - 8.84, 'M_Error': 1.0, 'Name': 'Be12L', 'BL_Type': 'Estimated'},
    {'S': -1, 'A': 13, 'Z': 5, 'M': 11188.744 + 1115.683 - 12.481, 'M_Error': 1.0, 'Name': 'B13L', 'BL_Type': 'Estimated'},
    {'S': -1, 'A': 14, 'Z': 5, 'M': 12123.430 + 1115.683 - 13.605, 'M_Error': 1.0, 'Name': 'B14L', 'BL_Type': 'Estimated'},
    {'S': -1, 'A': 11, 'Z': 6, 'M': 9327.574 + 1115.683 - 10.103, 'M_Error': 1.0, 'Name': 'C11L', 'BL_Type': 'Estimated'},
    {'S': -1, 'A': 15, 'Z': 6, 'M': 13040.872 + 1115.683 - 13.158, 'M_Error': 1.0, 'Name': 'C15L', 'BL_Type': 'Estimated'},
    {'S': -1, 'A': 16, 'Z': 6, 'M': 13979.219 + 1115.683 - 13.922, 'M_Error': 1.0, 'Name': 'C16L', 'BL_Type': 'Estimated'},
    {'S': -1, 'A': 13, 'Z': 7, 'M': 11191.691 + 1115.683 - 12.213, 'M_Error': 1.0, 'Name': 'N13L', 'BL_Type': 'Estimated'},
    {'S': -1, 'A': 17, 'Z': 7, 'M': 14906.013 + 1115.683 - 14.466, 'M_Error': 1.0, 'Name': 'N17L', 'BL_Type': 'Estimated'},
    {'S': -1, 'A': 18, 'Z': 7, 'M': 15839.694 + 1115.683 - 15.029, 'M_Error': 1.0, 'Name': 'N18L', 'BL_Type': 'Estimated'},]
double_hyper = [
    {'S': -2, 'A': 4, 'Z': 1, 'M': 1875.613 + (1115.683 - 0.13) * 2, 'M_Error': 0.05 * 2, 'Name': 'H4LL', 'BL_Type': 'Published'},
    {'S': -2, 'A': 5, 'Z': 1, 'M': 2808.921 + (1115.683 - 2.04) * 2, 'M_Error': 0.04 * 2, 'Name': 'H5LL', 'BL_Type': 'Published'},
    {'S': -2, 'A': 6, 'Z': 1, 'M': 3750.086 + (1115.683 - 3.950) * 2, 'M_Error': 1.0 * 2, 'Name': 'H6LL', 'BL_Type': 'Estimated'},
    {'S': -2, 'A': 5, 'Z': 2, 'M': 2808.391 + (1115.683 - 2.39) * 2, 'M_Error': 0.03 * 2, 'Name': 'He5LL', 'BL_Type': 'Published'},
    {'S': -2, 'A': 6, 'Z': 2, 'M': 3727.379 + (1115.683 - 3.12) * 2, 'M_Error': 0.02 * 2, 'Name': 'He6LL', 'BL_Type': 'Published'},
    {'S': -2, 'A': 7, 'Z': 2, 'M': 4667.680 + (1115.683 - 4.18) * 2, 'M_Error': 0.10 * 2, 'Name': 'He7LL', 'BL_Type': 'Published'},
    {'S': -2, 'A': 8, 'Z': 2, 'M': 5605.534 + (1115.683 - 5.55) * 2, 'M_Error': 0.15 * 2, 'Name': 'He8LL', 'BL_Type': 'Published'},
    {'S': -2, 'A': 9, 'Z': 2, 'M': 6545.510 + (1115.683 - 7.16) * 2, 'M_Error': 0.70 * 2, 'Name': 'He9LL', 'BL_Type': 'Published'},
    {'S': -2, 'A': 10, 'Z': 2, 'M': 7482.540 + (1115.683 - 6.599) * 2, 'M_Error': 1.0 * 2, 'Name': 'He10LL', 'BL_Type': 'Estimated'},
    {'S': -2, 'A': 11, 'Z': 2, 'M': 8423.360 + (1115.683 - 7.456) * 2, 'M_Error': 1.0 * 2, 'Name': 'He11LL', 'BL_Type': 'Estimated'},
    {'S': -2, 'A': 7,  'Z': 3, 'M': 4667.616 + (1115.683 - 4.50) * 2, 'M_Error': 0.50 * 2, 'Name': 'Li7LL', 'BL_Type': 'Published'},
    {'S': -2, 'A': 8,  'Z': 3, 'M': 5601.518 + (1115.683 - 5.58) * 2, 'M_Error': 0.03 * 2, 'Name': 'Li8LL', 'BL_Type': 'Published'},
    {'S': -2, 'A': 9,  'Z': 3, 'M': 6533.833 + (1115.683 - 6.80) * 2, 'M_Error': 0.03 * 2, 'Name': 'Li9LL', 'BL_Type': 'Published'},
    {'S': -2, 'A': 10, 'Z': 3, 'M': 7471.365 + (1115.683 - 8.50) * 2, 'M_Error': 0.12 * 2, 'Name': 'Li10LL', 'BL_Type': 'Published'},
    {'S': -2, 'A': 11, 'Z': 3, 'M': 8406.868 + (1115.683 - 9.418) * 2, 'M_Error': 1.0 * 2, 'Name': 'Li11LL', 'BL_Type': 'Estimated'},
    {'S': -2, 'A': 12, 'Z': 3, 'M': 9346.460 + (1115.683 - 10.705) * 2, 'M_Error': 1.0 * 2, 'Name': 'Li12LL', 'BL_Type': 'Estimated'},
    {'S': -2, 'A': 8,  'Z': 4, 'M': 5605.296 + (1115.683 - 5.16) * 2, 'M_Error': 0.08 * 2, 'Name': 'Be8LL', 'BL_Type': 'Published'},
    {'S': -2, 'A': 9,  'Z': 4, 'M': 6534.184 + (1115.683 - 6.84) * 2, 'M_Error': 0.05 * 2, 'Name': 'Be9LL', 'BL_Type': 'Published'},
    {'S': -2, 'A': 10, 'Z': 4, 'M': 7454.851 + (1115.683 - 6.71) * 2, 'M_Error': 0.04 * 2, 'Name': 'Be10LL', 'BL_Type': 'Published'},
    {'S': -2, 'A': 11, 'Z': 4, 'M': 8392.751 + (1115.683 - 8.60) * 2, 'M_Error': 0.17 * 2, 'Name': 'Be11LL', 'BL_Type': 'Published_i'},
    {'S': -2, 'A': 12, 'Z': 4, 'M': 9325.504 + (1115.683 - 8.21) * 2, 'M_Error': 1.0 * 2, 'Name': 'Be12LL', 'BL_Type': 'Estimated'},
    {'S': -2, 'A': 13, 'Z': 4, 'M': 10264.568 + (1115.683 - 8.84) * 2, 'M_Error': 1.0 * 2, 'Name': 'Be13LL', 'BL_Type': 'Estimated'},
    {'S': -2, 'A': 10, 'Z': 5, 'M': 7472.320 + (1115.683 - 8.29) * 2, 'M_Error': 0.18 * 2, 'Name': 'B10LL', 'BL_Type': 'Published'},
    {'S': -2, 'A': 11, 'Z': 5, 'M': 8393.309 + (1115.683 - 8.89) * 2, 'M_Error': 0.12 * 2, 'Name': 'B11LL', 'BL_Type': 'Published'},
    {'S': -2, 'A': 12, 'Z': 5, 'M': 9324.437 + (1115.683 - 10.24) * 2, 'M_Error': 0.05 * 2, 'Name': 'B12LL', 'BL_Type': 'Published'},
    {'S': -2, 'A': 13, 'Z': 5, 'M': 10252.548 + (1115.683 - 11.37) * 2, 'M_Error': 0.06 * 2, 'Name': 'B13LL', 'BL_Type': 'Published'},
    {'S': -2, 'A': 14, 'Z': 5, 'M': 11188.744 + (1115.683 - 12.481) * 2, 'M_Error': 1.0 * 2, 'Name': 'B14LL', 'BL_Type': 'Estimated'},
    {'S': -2, 'A': 15, 'Z': 5, 'M': 12123.430 + (1115.683 - 13.605) * 2, 'M_Error': 1.0 * 2, 'Name': 'B15LL', 'BL_Type': 'Estimated'},
    {'S': -2, 'A': 12, 'Z': 6, 'M': 9327.574 + (1115.683 - 10.103) * 2, 'M_Error': 1.0 * 2, 'Name': 'C12LL', 'BL_Type': 'Estimated'},
    {'S': -2, 'A': 13, 'Z': 6, 'M': 10254.019 + (1115.683 - 10.80) * 2, 'M_Error': 0.18 * 2, 'Name': 'C13LL', 'BL_Type': 'Published'},
    {'S': -2, 'A': 14, 'Z': 6, 'M': 11174.864 + (1115.683 - 11.69) * 2, 'M_Error': 0.12 * 2, 'Name': 'C14LL', 'BL_Type': 'Published'},
    {'S': -2, 'A': 15, 'Z': 6, 'M': 12109.483 + (1115.683 - 12.17) * 2, 'M_Error': 0.33 * 2, 'Name': 'C15LL', 'BL_Type': 'Published'},
    {'S': -2, 'A': 16, 'Z': 6, 'M': 13040.872 + (1115.683 - 13.158) * 2, 'M_Error': 1.0 * 2, 'Name': 'C16LL', 'BL_Type': 'Estimated'},
    {'S': -2, 'A': 17, 'Z': 6, 'M': 13979.219 + (1115.683 - 13.922) * 2, 'M_Error': 1.0 * 2, 'Name': 'C17LL', 'BL_Type': 'Estimated'},
    {'S': -2, 'A': 14, 'Z': 7, 'M': 11191.691 + (1115.683 - 12.213) * 2, 'M_Error': 1.0 * 2, 'Name': 'N14LL', 'BL_Type': 'Estimated'},
    {'S': -2, 'A': 15, 'Z': 7, 'M': 12111.193 + (1115.683 - 12.17) * 2, 'M_Error': 0.33 * 2, 'Name': 'N15LL', 'BL_Type': 'Published'},
    {'S': -2, 'A': 16, 'Z': 7, 'M': 13040.204 + (1115.683 - 13.59) * 2, 'M_Error': 0.15 * 2, 'Name': 'N16LL', 'BL_Type': 'Published'},
    {'S': -2, 'A': 17, 'Z': 7, 'M': 13968.936 + (1115.683 - 13.76) * 2, 'M_Error': 0.16 * 2, 'Name': 'N17LL', 'BL_Type': 'Published'},
    {'S': -2, 'A': 18, 'Z': 7, 'M': 14906.013 + (1115.683 - 14.466) * 2, 'M_Error': 1.0 * 2, 'Name': 'N18LL', 'BL_Type': 'Estimated'},
    {'S': -2, 'A': 19, 'Z': 7, 'M': 15839.694 + (1115.683 - 15.029) * 2, 'M_Error': 1.0 * 2, 'Name': 'N19LL', 'BL_Type': 'Estimated'},]
xi_atom = [
    {'S': -2, 'A': 13, 'Z': 5, 'M': 11174.864 + 1321.71, 'Name': 'Xi- & C12'},
    {'S': -2, 'A': 14, 'Z': 5, 'M': 12109.483 + 1321.71, 'Name': 'Xi- & C13', 'Rare': True},
    {'S': -2, 'A': 15, 'Z': 6, 'M': 13040.204 + 1321.71, 'Name': 'Xi- & N14'},
    {'S': -2, 'A': 16, 'Z': 6, 'M': 13968.936 + 1321.71, 'Name': 'Xi- & N15', 'Rare': True},
    {'S': -2, 'A': 17, 'Z': 7, 'M': 14895.082 + 1321.71, 'Name': 'Xi- & O16'},
    #{'S': -2, 'A': 18, 'Z': 7, 'M': 15830.504 + 1321.71, 'Name': 'Xi- & O17', 'Rare': True},
    {'S': -2, 'A': 19, 'Z': 7, 'M': 16762.024 + 1321.71, 'Name': 'Xi- & O18', 'Rare': True},
    ]
sigma_atom = [
    {'S': -1, 'A': 13, 'Z': 5, 'M': 11174.864 + 1197.449, 'Name': 'Sigma- & C12'},
    {'S': -1, 'A': 14, 'Z': 5, 'M': 12109.483 + 1197.449, 'Name': 'Sigma- & C13', 'Rare': True},
    {'S': -1, 'A': 15, 'Z': 6, 'M': 13040.204 + 1197.449, 'Name': 'Sigma- & N14'},
    {'S': -1, 'A': 16, 'Z': 6, 'M': 13968.936 + 1197.449, 'Name': 'Sigma- & N15', 'Rare': True},
    {'S': -1, 'A': 17, 'Z': 7, 'M': 14895.082 + 1197.449, 'Name': 'Sigma- & O16'},
    #{'S': -1, 'A': 18, 'Z': 7, 'M': 15830.504 + 1197.449, 'Name': 'Sigma- & O17', 'Rare': True},
    {'S': -1, 'A': 19, 'Z': 7, 'M': 16762.024 + 1197.449, 'Name': 'Sigma- & O18', 'Rare': True},
    ]
lepton = [{'S': 0, 'A': 0, 'Z': -1, 'M': 0.511, 'Name': 'e-'},
    {'S': 0, 'A': 0, 'Z': 1, 'M': 0.511, 'Name': 'e+'},
    {'S': 0, 'A': 0, 'Z': -1, 'M': 105.658, 'Name': 'mu-'},
    {'S': 0, 'A': 0, 'Z': 1, 'M': 105.658, 'Name': 'mu+'}]
hyperon = [
    {'S': -2, 'A': 0, 'Z': -1, 'M': 1321.71, 'Name': 'Xi-'},
    {'S': -1, 'A': 0, 'Z': -1, 'M': 1197.449, 'Name': 'Sigma-'},
    {'S': -1, 'A': 0, 'Z': 1, 'M': 1187.37, 'Name': 'Sigma+'}]
meson = [
    {'S': -1, 'A': 0, 'Z': -1, 'M': 493.677, 'Name': 'K-'},
    {'S': +1, 'A': 0, 'Z': +1, 'M': 493.677, 'Name': 'K+'},
    {'S': 0, 'A': 0, 'Z': +1, 'M': 139.571, 'Name': 'pi+'},
    {'S': +1, 'A': 1, 'Z': -1, 'M': 139.570+1115.683, 'Name': 'pi- & L'},
    ]

def search(name):
    for p in normal + neutrals + single_hyper + double_hyper + lepton + hyperon + meson:
        if p["Name"] == name:
            return p
    raise Exception("Particle {} is not found".format(name))

def search_in_atom(name):
    for p in xi_atom + sigma_atom:
        if p["Name"] == name:
            return p
    raise Exception("Particle {} is not found".format(name))

def get_m_error(name):
    for p in normal + neutrals + single_hyper + double_hyper + lepton:
        if p["Name"] == name:
            if "M_Error" in p:
                return p["M_Error"]
            else:
                return 0
    raise Exception("Particle {} is not found".format(name))

def convert_json():
    nuclide = {}
    nuclide["Normal"] = normal
    nuclide["Neutrals"] = neutrals
    nuclide["SingleHyper"] = single_hyper
    nuclide["DoubleHyper"] = double_hyper
    nuclide["XiAtom"] = xi_atom
    nuclide["SigmaAtom"] = sigma_atom
    
    def rounding_mass(nuclei):
        for nuclide in nuclei:
            nuclide['M'] = float("{:.3f}".format(nuclide['M']))
    for nuclei in nuclide.values():
        rounding_mass(nuclei)
    import json
    with open("nuclide.json","w") as f:
        json.dump(nuclide, f, indent=1)

def convert_cpp():

    header = '#pragma once\n'
    header += '#include <map>\n\n'
    header += 'std::pair<double, int> get_mass_z(std::string name) {\n\n'
    header += '    std::map<std::string, std::pair<double, int>> nuclide;\n\n'
    all_nuclide = []
    all_nuclide.extend(normal)
    all_nuclide.extend(neutrals)
    all_nuclide.extend(single_hyper)
    all_nuclide.extend(double_hyper)
    for n in all_nuclide:
        header += '    nuclide["{}"] = std::make_pair({:.3f}, {});\n'.format(n["Name"],n["M"],n["Z"])
    header +='    return nuclide.at(name);\n}'
    with open("nuclide.hpp","w") as f:
        f.write(header)

if __name__ == '__main__':
    convert_json()
    convert_cpp()
